---
backlinks:
  - Windowsの常時プログラムを作ったときの設定
date: 2022-10-15 00:29:18 +0900
published: true
---

# Windows PCでMac風キーバインドを目指す（G915 TKL編）

背景

- 今までUS配列の[[Magic Keyboard]]を使っていて、以下の設定で満足していた
  - [Windows PCでMac風キーバインドを目指す - chikuwa111](https://scrapbox.io/chikuwa111/Windows_PC%E3%81%A7Mac%E9%A2%A8%E3%82%AD%E3%83%BC%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%82%92%E7%9B%AE%E6%8C%87%E3%81%99)
  - [続 Windows PCでMac風キーバインドを目指す - chikuwa111](https://scrapbox.io/chikuwa111/%E7%B6%9A_Windows_PC%E3%81%A7Mac%E9%A2%A8%E3%82%AD%E3%83%BC%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%82%92%E7%9B%AE%E6%8C%87%E3%81%99)
  - [RCtrlで入力切替が起きないようにする - chikuwa111](https://scrapbox.io/chikuwa111/RCtrl%E3%81%A7%E5%85%A5%E5%8A%9B%E5%88%87%E6%9B%BF%E3%81%8C%E8%B5%B7%E3%81%8D%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B)
- この度新たに[[G915 TKL]]を使うようになって、キー配列が変わったため設定を見直す必要が出てきた

前提情報

- キー配列の違い
  - [[Magic Keyboard]]
    - スペースの左右にCmd
    - Cmdの外側にAlt
  - [[G915 TKL]]
    - スペースの左右にAlt

実現したいこと

- LAlt単体押しで半角入力
- RAlt単体押しで全角入力
- AltがCtrlのように使える
  - Alt + aで全選択
  - Alt + cでコピー
  - などなど
- LCtrlがMacの持っている[[Emacs]]風キーバインドに対応している
  - LCtrl + aで行頭
  - LCtrl + eで行末
  - などなど

やること

- [[ChgKey]]
  - CapsLockとCtrlを入れ替える
  - スペースバー左のキーをLWin, LAlt, RCtrl, Spaceにする
- [[Google日本語入力IME]]
  - 無変換キーと変換キーそれぞれに入力切替を当てる
- [[AutoHotKey]]
  - RCtrl単体押しで無変換キー判定にする
  - RAlt単体押しで変換キー判定にする
  - LCtrlで[[Emacs]]風キーバインドが出るようにする
    - 両Ctrlに適用すると本当にCtrlを使いたいときに困るので左だけにした

[[AutoHotKey]]のスクリプト

- 単体押しの判定
  - 以下が大変参考になった
    - [WindowsのAlt空打ちで日本語入力(IME)を切り替えるツールを作った - karakaram-blog](https://www.karakaram.com/alt-ime-on-off/)
    - https://github.com/karakaram/alt-ime-ahk/blob/master/alt-ime-ahk.ahk
  - ↑を参考にしつつ、LAltをRCtrlにしたものが[[easy-input-switch-ahk]]
- LCtrlで[[Emacs]]風キーバインドが出るようにする
  - [[emacs-like-key-bindings-ahk]]
- 上記2つをIncludeしたものを実行する

[//begin]: # "Autogenerated link references for markdown compatibility"
[G915 TKL]: <G915 TKL> "G915 TKL"
[G915 TKL]: <G915 TKL> "G915 TKL"
[easy-input-switch-ahk]: easy-input-switch-ahk "easy-input-switch-ahk"
[emacs-like-key-bindings-ahk]: emacs-like-key-bindings-ahk "emacs-like-key-bindings-ahk"
[//end]: # "Autogenerated link references"